<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ssm.dao.TAnswerMapper" >
	<resultMap id="BaseResultMap" type="com.ssm.pojo.TAnswer" >
    	<id column="id" property="id" jdbcType="INTEGER" />
    	<result column="question_id" property="questionId" jdbcType="INTEGER"/>
	    <result column="answer_content" property="answerContent" jdbcType="VARCHAR" />
	    <result column="is_answer_true" property="isAnswerTrue" jdbcType="INTEGER" />
	    <result column="answer_select" property="answerSelect" jdbcType="VARCHAR" />
	    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
	    <result column="update_time" property="updateTime" jdbcType="TIMESTAMP" />
  </resultMap>
  
  <insert id="addAnswer" parameterType="com.ssm.pojo.TAnswer">
  		INSERT INTO t_answer(`question_id`,`answer_content`,`is_answer_true`,`answer_select`,`create_time`,`update_time`) 
  		VALUES(#{questionId},#{answerContent},#{isAnswerTrue},#{answerSelect},now(),now())
  </insert>
  
  <select id="selectAnswerByQuestionId" parameterType="integer" resultMap="BaseResultMap">
  		SELECT 
  			t_answer.id,
  			t_answer.question_id,
  			t_answer.answer_content,
  			t_answer.is_answer_true,
  			t_dict.label AS 'answer_select' 
  		FROM 
  			(SELECT * FROM t_answer WHERE t_answer.question_id = #{questionId}) t_answer 
  		LEFT JOIN 
  			t_dict 
		ON 
			t_answer.answer_select = t_dict.id 
  </select>
  
  <update id="updateAnswerByQuestionId">
 		UPDATE 
 			t_answer 
 		SET
 			<if test="answerContent != null and answerContent != ''">
 				`answer_content` = #{answerContent},
 			</if>
 			<if test="isAnswerTrue != null and isAnswerTrue != ''">
 				`is_answer_true` = #{isAnswerTrue},
 			</if>
 			`update_time` = now()
 		WHERE 
 			`question_id` = #{questionId}
 		AND
 			`answer_select` = #{answerSelect} 
  </update>
</mapper>