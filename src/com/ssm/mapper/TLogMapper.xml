<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.ssm.dao.TLogDao">
	
	
	<resultMap type="com.ssm.vo.TLogVo" id="Log">
		<result property="loginName"  column="login_name"/>
		<result property="loginIp"  column="login_ip"/>
		<result property="createTimeS" column="create_time"/>
		<result property="updateTimeS" column="update_time"/>
		<result property="updatePerson" column="update_person"/>
	</resultMap>
		
	<select id="selecLogPage" resultMap="Log" parameterType="com.ssm.util.Page" >
		SELECT  * FROM t_Log  	
		<where>
			<if test="loginName!=null and loginName!=''">
				 and login_name like '%' #{loginName} '%'
			</if>
			
			<if test="ip!=null and ip!=''">
				 and login_ip like '%' #{ip} '%'
			</if>
			
			<if test="startTime!=null and startTime!=''">
				 and create_time &gt;= #{startTime} 
			</if>
			<if test="endTime!=null and endTime!=''">
				 and create_time &lt;= #{endTime} 
			</if>
			<if test="1==1">
				and  status=1
			</if>
			
		</where>
		 ORDER BY `create_time` DESC  LIMIT #{page},#{limit}	
	</select>
	
	
	
	<select id="selecLogCount" parameterType="com.ssm.util.Page" resultType="Long">
		select count(1)  from t_Log
		<where>
			<if test="loginName!=null and loginName!=''">
				 and login_name like '%' #{loginName} '%'
			</if>
			<if test="ip!=null and ip!=''">
				 and login_ip like '%' #{ip} '%'
			</if>
			<if test="startTime!=null and startTime!=''">
				 and create_time &gt;= #{startTime} 
			</if>
			<if test="endTime!=null and endTime!=''">
				 and create_time &lt;= #{endTime} 
			</if>
			<if test="1==1">
				and  status=1
			</if>
		</where>
	</select>
	
	
	
	
	<insert id="addLog"  parameterType="com.ssm.vo.TLogVo"   useGeneratedKeys="true" keyColumn="id" keyProperty="id">
			INSERT INTO t_log (msg,login_ip,login_name,create_time) VALUES (#{msg},#{loginIp},#{loginName},#{createTime});
	</insert>
	
	
	<update id="upLog" parameterType="com.ssm.vo.TLogVo">
		update t_Log 
		<set>			
			<if test="loginName!=null and loginName!='' ">
				login_name=#{loginName},
			</if>
			<if test="loginIp!=null and loginIp!=''">
				login_ip=#{loginIp},
			</if>
			<if test="msg!=null and msg!=''">
				msg=#{msg},
			</if>
			<if test="updateTime!=null and updateTime!=''">
				update_time=#{updateTime},
			</if>
			<if test="updatePerson!=null and updatePerson!=''">
				update_person=#{updatePerson},
			</if>
		</set>	
		where id=#{id}
	</update>
	
	<delete id="delLog" parameterType="com.ssm.vo.TLogVo">
			update t_Log set status=2 where id=#{id}
	</delete>
	
		


</mapper>

